---
title: "EDX Capstone MovieLens Project"
author: "Fernando A. Mitidieri"
date: "29/12/2023"
output:
  pdf_document: default
  html_document:
    df_print: paged
  word_document: default
subtitle: Report and findings
file: EDX_Capstone_Final.rmd
---

```{r , include = FALSE}
library(dplyr)
library(utils)
```

```{r load edxOriginal, echo = FALSE}
load("ml-10M100K/movielens.RData")
load("ml-10M100K/edx_original.RData")
load("ml-10M100K/validation.RData")
load("ml-10M100K/edx.RData")
load("ml-10M100K/final_holdout_test.RData")
```

## 1. Introduction
This is a report for the final project of HarvardX Data Science Program to obtain the professional certificate.\ 

The goal of this project is to create a recommendation system to movies based on dataset MovieLens. The dataset will be used to training models that will be validate using RMSE as the loss function to evaluate which one has better performance.\

The goal of this project is create a recommendation system of movies for users. It should come up with a movie title recommendation based on the other features presented into dataset.

This project was saved using GitHub to control versions and the source code. Below follow the public address to access all files of this project:\
\
https://github.com/fmitidieri/EDX_Movielens \
\
In the project directory will be found the following files:

1. EDX_Capstone_Final.R - script in R with all development of the model.
2. EDX_Capstone_Final.RMD - RMD file to generate the report in a pdf format.
3. A report in PDF format.

There are also two subdirectories under the main one, that are used to store data and pictures used to generate the report:

1. figures/
2. ml-10M100K/

\
Movielens is a large and sparse dataset with `r n_distinct(movielens$movieId)` movies, `r n_distinct(movielens$userId)` users and `r length(movielens$rating)` different rates.\ 
Dataset is composed by `r ncol(movielens)` columns: `r colnames(movielens)`.\
Below we can verify the type of each feature:

```{r headOriginal, echo=FALSE}
knitr::kable(str(movielens, vec.len = 3, digits.d = 3), caption = "Movielens variable types")
```

To accomplish the goal defined above, will be necessary a bunch of steps that follow:

a) Download complete dataset from http://files.grouplens.org/datasets/movielens/ml-10m.zip.
b) Generate edx_original and final_holdout_test sets. 
c) Pre-processing data.
d) From edx_original dataset, generate edx training and validation sets. 
e) Execute a data exploration and previous analysis of data.
f) Put down findings.
g) Develop models. 
h) Calculate and verify RMSE. 
i) Compare results. 
j) Run the final model with final_holdout_test dataset
l) Conclusion.


## 2. Exploratory Analysis 

a) Download complete dataset.

Was used the script provided in the assessment to download the movielens data from http://files.grouplens.org/datasets/movielens/ml-10m.zip, then combine the files ratings.dat and movies.dat to generate the movielens data set.\ 

b) Generate edx_original and final_holdout_test sets.

After that dataset movielens had been downloaded, was created two different datasets:\

i) Final_holdout_test - should be used only when the final model had been chose. It is important that final model be tested with a unused dataset. The Final_handout_test set is equivalent of 10% of data from movielens.
Total rows in the Final_holdout_test dataset is: `r nrow(final_holdout_test)`\

ii) edx_original - From those 90% that wasn't used in Final_handout_test set, it will be used to creat two different sets: edx and validation datasets.
Total rows in the edx_original dataset is: `r nrow(edx_original)`\

After created the datasets, they were saved as a Rdata file to be used during the development stage of analysis.\

c) Pre-processing data

Before preform the segregation of edx_original dataset, was performed some data transformations on the data. The goal is avoid use strings when running the modeling stage of the work.\ 
So, were identified many features and figure out a way to transform them from character type to numerical type.\ 
To perform this pre-preocessing and preserve the dataset original, was creates a copy of this and named edx.\ 

c.1) The first data transformation was created a table to relate movieID with title, this will be used to handle only Ids as numerical data instead handle title that are strings.
As result, was created a table with movieId and movie title.\ 

c.2) The second pre-processing was identify the year of issuance from the title column for each movie, take out of the string and transform it to be used as a new numerical feature. Was created a new column in the edx dataset.\

c.3) In context of this analysis month and day of movie launching do not add as much information and would certainly causes increase in processing time, so a decision was made to keep only the year of movie launching and transform the date column into a year column. And then timestamp column that will no longer be used was deleted from the dataset.\

c.4)  The genre column was substituted by a reference number. Again, process numbers is easier than process strings. The idea is substitute each combination by a number, For each different combination of genre will be assigned a unique number.
Now that was generated the genreNumber table, these numbers will replace the strings of characters of the genre in the edx data set.\

```{r load edx, echo = FALSE}
load("ml-10M100K/edx_original.RData")
knitr::kable(str(edx, vec.len = 3, digits.d = 3), caption = "edx dataset after data transformation")
```

\
d) From edx_original dataset, generate edx training and validation sets.

From the edx_original was created two different sets: edx and validation.\

d.1) edx - has 90% of data from edx_original dataset and it is to be used to training the models. Total rows in the edx dataset:  `r nrow(edx)`\

d.2)validation - has 10% of edx_original dataset and it is used to assess the models before the final validation with the Final_holdout_test dataset. Total rows in the validation dataset: `r nrow(validation)`\

e) Execute a data exploration and previous analysis of data.

First of all, the edx dataset is inspected:

```{r edxsummary, echo = FALSE}
glimpse(edx)
```
\
One important characteristic of this dataset is that there are many users and many movies, but few rating if we consider all possibilities. Bellow is possible to 
analysis how sparse the movielens data is. The size of matrix used to generates the plot was constrict into 1000x1000 users by items.\

```{r load figure1, fig.width=7, fig.height=4, fig.align = 'center', echo=FALSE}
load("figures/figure1.RData")
figure1
```
\
Just to make it clear, the plot above is plotted again but now with only 50x50 users and items. This characteristic of such matrix shows that.... "COMPLETE WITH SOME EXPLANATION FROM ARTICLES"\

```{r load figure1x, fig.width=7, fig.height=4, fig.align = 'center', echo = FALSE}
load("figures/figure1x.RData")
figure1x
```

A natural analysis is find how ratings are distributed along data. It is possible to discover that the mean is around 3.51 stars and that users trend to give higher ratings. This is perceived by the 

```{r load figure2, fig.width=7, fig.height=4, fig.align = 'center', echo = FALSE}
load("figures/figure2.RData")
figure2
```

There are the top 10 users

```{r load figure3, fig.width=7, fig.height=4, fig.align = 'center', echo = FALSE}
load("figures/figure3.RData")
figure3
```


There are the top 10 movies

```{r load figure4, fig.width=7, fig.height=4, fig.align = 'center', echo = FALSE}
load("figures/figure4.RData")
figure4
```

Top 10 Genres rated

```{r load figure5, fig.width=7, fig.height=4, fig.align = 'center', echo = FALSE}
load("figures/figure5.RData")
figure5
```

Ratings distribution among Genres

```{r load figure6, fig.width=7, fig.height=4, fig.align = 'center', echo = FALSE}
load("figures/figure6.RData")
figure6
```


And lest the disctribuition of the ratings along the years

```{r load figure7, fig.width=7, fig.height=4, fig.align = 'center', echo = FALSE}
load("figures/figure7.RData")
figure7
```



## 3. Results
```{r load edxresults, echo=FALSE}
load("ml-10M100K/RMSE_Table.RData")
```

```{r results, echo=FALSE}
knitr::kable(RMSE_Table, caption = "Final Results")
```


## 4. Conclusion



## References

